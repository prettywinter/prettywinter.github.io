---
layout: wiki
wiki: Java
title: 微服务
order: 51
---

很奇怪吧，在 Java 系列的 Spring 框架中，进来就是微服务整理？！

没办法，现在项目的微服务就是 **为了用而用**，也可以说是丰富自己的简历，便于跳槽时有相关的使用经验。

说个题外话，很多项目是可以不用微服务完全撑的起来的，但是程序员这行现在有很多转行过来的，培训的也有，这几导致现在 IT 的从业者特别多，每个人的想法不同，期望高工资的不少，跳槽是常事。所以项目经验的多少、技术深浅的掌握在面试时是很重要的。

<!-- more -->

进入正题，这个只是介绍一下组件，无关使用，其实也很简单 :slightly_smiling_face:。

## 一、关于微服务

顾名思义，把一整个大的项目分成几个小服务（类比模块式开发），每个服务都可以独立部署，独立开发，独立运维，独立测试，独立上线。

微服务架构的优点一大把，不说了。缺点显而易见，部署、维护比较难，没经验是很吃亏的，不仅需要大量的时间研究，有很多坑需要自己切切实实踩了之后才知道。

每种语言都可以有微服务，并不限于 Java，当然更多的是 Web。

随着微服务的发展，出现了很多的微服务工具集，这些一站式微服务工具，帮助我们解决了分布式系统中各种问题，让开发人员更专注于自己的业务开发。

目前主流有两种搭建微服务的方式：一种是 Spring Cloud 整合的微服务工具集，另一种是阿里开源的 Spring Cloud Alibaba 微服务一站式解决方案。

当然也可以自己选择最适合自己项目的工具，因为上面的工具集也是单一的工具整合起来使用的。微服务也可以理解成就是工具的选用，这也是比较重要的，选择不同的方案后续遇到问题解决得方案也会不同。

微服务时代充满着自由的气息，微服务时代充斥着迷茫的选择。

单单服务间的远程调用都有解决方案，比如 RMI（Sun/Oracle）、Thrift（Facebook）、Dubbo（阿里巴巴）、gRPC（Google）、otan2（新浪）、Finagle（Twitter）、brpc（百度）、Arvo（Hadoop）、JSON-RPC、REST 等。

## 二、Java 微服务组件

微服务最重要得是工具的选择，主要得稳（和很多人用 java8 一样）。组件千千万，选择第一站。看看下面的部分工具吧，阿里系的可以参看 spring-cloud-alibaba 的 github 的文章：https://github.com/alibaba/spring-cloud-alibaba/blob/2.2.x/README-zh.md

### 1. 服务注册与发现中心组件(管理微服务的健康值状态)

1. Eureka(Netflix)
2. Consul(HashiCorp,GO语言编写)，启动后可以访问 ip:8500 进入管理页面
3. Nacos(Alibaba开源)，启动后可以使用 ip:8848 进入管理页面
4. Zookeeper(Apache,Java语言编写)

### 2. 服务间通信组件（远程调用）

1. RestTemplate + Ribbon(NetFlix)实现负载均衡
2. OpenFeign(包含Ribbon)伪http客户端，支持Spring注解(推荐)
3. Dubbo（阿里开源）

RestTemplate 与 Openfegin 对比：

- RestTemplate 将路径写死在代码中，不利于维护。
- Openfegin组件(内部集成了Ribbon)：解决了 RestTemplate 实现服务间通信的所有问题，并且使用简单，支持注解。

> 使用 OpenFeign 组件进行客户端的服务通信时，映射地址(@RequestMapping)和被调用的 FeignClient 的对应的方法映射地址必须相同；方法名称可以不同，但为确保一致性，推荐使用相同的方法名和相同的映射地址。

### 3. 服务熔断器组件（解决服务雪崩问题）

1. Hystrix(进入了维护模式)以及对应的可视化展示工具 Hystrix DashBoard
2. Sentinel（阿里开源）

Hystrix 断路器打开条件：

- 当满足一定的阈值，默认10秒内超过20个请求
- 当失败率达到一定的时候，默认10秒内超过50%的请求失败

### 4. 服务网关中心组件（提供请求统一入口，路由转发，过滤）

1. Gateway (转发、负载均衡、断言、过滤)
2. zuul1.x zuul2.x
3. Nacos（阿里开源）

### 5. 服务统一配置中心组件

1. config 组件：
    ConfigServer 获取远程仓库的地址存入本地仓库
    ConfigClient 根据 ConfigServer 读取自身配置
2. bus 组件：消息总线：将微服务所有节点链接到一起，通过总线实现自动配置刷新
3. Nacos（阿里开源）

### 6. 事务组件

1. Seata：阿里巴巴开源产品，一个易于使用的高性能微服务分布式事务解决方案。

## 三、附

在使用 Spring Cloud Alibaba 时，[版本选择](https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E) 是很重要的，可以参考官方的说明：https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E。